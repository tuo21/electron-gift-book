{"version":3,"file":"preload.mjs","sources":["../electron/preload.ts"],"sourcesContent":["import { ipcRenderer, contextBridge } from 'electron'\r\n\r\n// 数据库操作 API 响应类型\r\ntype ApiResponse<T = unknown> = { success: boolean; data?: T; error?: string }\r\n\r\n// 数据库操作 API\r\ninterface DatabaseAPI {\r\n  getAllRecords: () => Promise<ApiResponse<any[]>>\r\n  getRecordById: (id: number) => Promise<ApiResponse<any>>\r\n  searchRecords: (keyword: string) => Promise<ApiResponse<any[]>>\r\n  insertRecord: (record: any) => Promise<ApiResponse<{ id: number }>>\r\n  updateRecord: (record: any) => Promise<ApiResponse>\r\n  softDeleteRecord: (id: number) => Promise<ApiResponse>\r\n  getRecordHistory: (recordId: number) => Promise<ApiResponse<any[]>>\r\n  getStatistics: () => Promise<ApiResponse<any>>\r\n}\r\n\r\n// --------- Expose some API to the Renderer process ---------\r\ncontextBridge.exposeInMainWorld('ipcRenderer', {\r\n  on(...args: Parameters<typeof ipcRenderer.on>) {\r\n    const [channel, listener] = args\r\n    return ipcRenderer.on(channel, (event, ...args) => listener(event, ...args))\r\n  },\r\n  off(...args: Parameters<typeof ipcRenderer.off>) {\r\n    const [channel, ...omit] = args\r\n    return ipcRenderer.off(channel, ...omit)\r\n  },\r\n  send(...args: Parameters<typeof ipcRenderer.send>) {\r\n    const [channel, ...omit] = args\r\n    return ipcRenderer.send(channel, ...omit)\r\n  },\r\n  invoke(...args: Parameters<typeof ipcRenderer.invoke>) {\r\n    const [channel, ...omit] = args\r\n    return ipcRenderer.invoke(channel, ...omit)\r\n  },\r\n})\r\n\r\n// 暴露数据库 API\r\ncontextBridge.exposeInMainWorld('db', {\r\n  getAllRecords: () => ipcRenderer.invoke('db:getAllRecords'),\r\n  getRecordById: (id: number) => ipcRenderer.invoke('db:getRecordById', id),\r\n  searchRecords: (keyword: string) => ipcRenderer.invoke('db:searchRecords', keyword),\r\n  insertRecord: (record: Record) => ipcRenderer.invoke('db:insertRecord', record),\r\n  updateRecord: (record: Record) => ipcRenderer.invoke('db:updateRecord', record),\r\n  softDeleteRecord: (id: number) => ipcRenderer.invoke('db:softDeleteRecord', id),\r\n  getRecordHistory: (recordId: number) => ipcRenderer.invoke('db:getRecordHistory', recordId),\r\n  getStatistics: () => ipcRenderer.invoke('db:getStatistics'),\r\n} as DatabaseAPI)\r\n\r\n// 类型声明，供渲染进程使用\r\ndeclare global {\r\n  interface Window {\r\n    db: DatabaseAPI\r\n  }\r\n}\r\n"],"names":["contextBridge","ipcRenderer","args"],"mappings":";;AAkBAA,SAAAA,cAAc,kBAAkB,eAAe;AAAA,EAC7C,MAAM,MAAyC;AAC7C,UAAM,CAAC,SAAS,QAAQ,IAAI;AAC5B,WAAOC,qBAAY,GAAG,SAAS,CAAC,UAAUC,UAAS,SAAS,OAAO,GAAGA,KAAI,CAAC;AAAA,EAC7E;AAAA,EACA,OAAO,MAA0C;AAC/C,UAAM,CAAC,SAAS,GAAG,IAAI,IAAI;AAC3B,WAAOD,qBAAY,IAAI,SAAS,GAAG,IAAI;AAAA,EACzC;AAAA,EACA,QAAQ,MAA2C;AACjD,UAAM,CAAC,SAAS,GAAG,IAAI,IAAI;AAC3B,WAAOA,qBAAY,KAAK,SAAS,GAAG,IAAI;AAAA,EAC1C;AAAA,EACA,UAAU,MAA6C;AACrD,UAAM,CAAC,SAAS,GAAG,IAAI,IAAI;AAC3B,WAAOA,qBAAY,OAAO,SAAS,GAAG,IAAI;AAAA,EAC5C;AACF,CAAC;AAGDD,SAAAA,cAAc,kBAAkB,MAAM;AAAA,EACpC,eAAe,MAAMC,SAAAA,YAAY,OAAO,kBAAkB;AAAA,EAC1D,eAAe,CAAC,OAAeA,SAAAA,YAAY,OAAO,oBAAoB,EAAE;AAAA,EACxE,eAAe,CAAC,YAAoBA,SAAAA,YAAY,OAAO,oBAAoB,OAAO;AAAA,EAClF,cAAc,CAAC,WAAmBA,SAAAA,YAAY,OAAO,mBAAmB,MAAM;AAAA,EAC9E,cAAc,CAAC,WAAmBA,SAAAA,YAAY,OAAO,mBAAmB,MAAM;AAAA,EAC9E,kBAAkB,CAAC,OAAeA,SAAAA,YAAY,OAAO,uBAAuB,EAAE;AAAA,EAC9E,kBAAkB,CAAC,aAAqBA,SAAAA,YAAY,OAAO,uBAAuB,QAAQ;AAAA,EAC1F,eAAe,MAAMA,qBAAY,OAAO,kBAAkB;AAC5D,CAAgB;"}