/**
 * 礼金簿打印样式
 * 用于 PDF 导出和打印
 * 使用 CSS 变量支持主题换肤
 * 
 * 字体规范：
 * - 姓名文本和大写金额：演示春风楷
 * - 固定文字内容：宋体
 * - 其他变量文字：楷体
 */

/* ==================== 字体定义 ==================== */
@font-face {
  font-family: '演示春风楷';
  src: url('./fonts/XuandongKaishu.ttf') format('truetype');
  font-weight: normal;
  font-style: normal;
  font-display: swap;
}

/* ==================== CSS 变量定义 ==================== */
:root {
  /* 主题色 */
  --theme-primary: #c44a3d;
  --theme-primary-dark: #a83f34;
  --theme-paper: #f5f0e8;
  --theme-accent: #eb564a;
  --theme-text-primary: #333333;
  --theme-text-secondary: #666666;
  --theme-text-light: #ffffff;
  --theme-border: #d4a574;
  
  /* 尺寸 - 297mm x 150mm 页面 */
  --page-width: 297mm;
  --page-height: 150mm;
  --column-width: 18.5mm;  /* 297mm / 15 = 19.8mm，考虑边距后调整为18.5mm */
  --column-height: 110mm;
  --column-gap: 0mm;  /* 间距为0，与电脑显示一致 */
  
  /* 字体 */
  --font-name-amount: '演示春风楷', 'KaiTi', 'STKaiti', serif;
  --font-family-fixed: 'SimSun', 'STSong', 'Noto Serif SC', serif;
  --font-family: 'KaiTi', 'STKaiti', 'SimSun', serif;
}

/* ==================== 页面设置 ==================== */
@page {
  size: 297mm 150mm;
  margin: 0;
}

* {
  margin: 0;
  padding: 0;
  box-sizing: border-box;
}

body {
  font-family: var(--font-family);
  background: var(--theme-primary);
  color: var(--theme-text-primary);
  line-height: 1.5;
  -webkit-print-color-adjust: exact;
  print-color-adjust: exact;
}

/* ==================== 打印容器 ==================== */
.print-container {
  width: var(--page-width);
  min-height: var(--page-height);
  padding: 5mm 8mm;  /* 上下5mm，左右8mm */
  background: var(--theme-primary);
  display: flex;
  flex-direction: column;
}

/* ==================== 页眉 ==================== */
.print-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-bottom: 2mm;  /* 减小底部间距 */
  padding-bottom: 2mm;  /* 减小底部内边距 */
  border-bottom: 1px solid rgba(255, 255, 255, 0.3);
}

.print-title {
  font-size: 24pt;
  font-weight: bold;
  color: var(--theme-text-light);
  margin: 0;
  font-family: var(--font-name-amount);
}

.print-meta {
  display: flex;
  gap: 15mm;
  font-size: 10pt;
  color: rgba(255, 255, 255, 0.9);
}

/* ==================== 礼金簿内容区 ==================== */
.print-content {
  flex: 1;
  display: flex;
  flex-direction: row;
  flex-wrap: nowrap;  /* 不换行，确保一行显示15个 */
  gap: var(--column-gap);
  background: rgba(255, 255, 255, 0.1);
  padding: 0;  /* 内边距为0 */
  align-content: flex-start;
  justify-content: flex-start;
  position: relative;  /* 用于汇总信息绝对定位 */
}

/* ==================== 记录列 ==================== */
.record-column {
  width: var(--column-width);
  height: var(--column-height);
  background: rgba(255, 255, 255, 0.95);
  border: 0.5mm solid var(--theme-border);
  display: flex;
  flex-direction: column;
  padding: 2mm;
  page-break-inside: avoid;
  break-inside: avoid;
  flex-shrink: 0;  /* 防止压缩 */
}

.empty-column {
}

/* ==================== 单元格 ==================== */
.cell {
  display: flex;
  flex-direction: column;
  align-items: center;
  padding: 1mm 0;
  border-bottom: 0.3mm dashed rgba(196, 74, 61, 0.2);
}

.cell:last-child {
  border-bottom: none;
}

/* 标签单元格 */
.label-cell {
  padding: 1mm 0;
  flex: 0 0 auto;
}

.label-text {
  font-size: 8pt;
  color: var(--theme-primary);
  font-weight: bold;
  font-family: var(--font-family-fixed);
}

/* 姓名单元格 */
.name-cell {
  flex: 0 0 auto;
  height: 38mm;
  min-height: 35mm;
  justify-content: center;
}

.name-text {
  color: var(--theme-text-primary);
  writing-mode: vertical-rl;
  text-orientation: upright;
  letter-spacing: 2mm;
  font-size: 20pt;
  line-height: 1.2;
  font-family: var(--font-name-amount);
}

/* 备注单元格 */
.remark-cell {
  flex: 0 0 auto;
  height: 6mm;
  min-height: 6mm;
  max-height: 6mm;
  justify-content: center;
  overflow: hidden;
}

.remark-text {
  font-size: 7pt;
  color: var(--theme-text-secondary);
  white-space: nowrap;
  overflow: hidden;
  text-overflow: ellipsis;
  font-family: var(--font-family);
}

/* 礼金单元格 */
.amount-cell {
  flex: 0 0 auto;
  height: 40mm;
  min-height: 35mm;
  justify-content: center;
}

.amount-content {
  display: flex;
  flex-direction: row;
  justify-content: center;
  align-items: flex-start;
  gap: 1mm;
  height: 100%;
}

.amount-chinese {
  color: var(--theme-text-primary);
  writing-mode: vertical-rl;
  text-orientation: upright;
  letter-spacing: 1mm;
  line-height: 1.4;
  font-size: 14pt;
  font-family: var(--font-name-amount);
}

.item-description {
  font-size: 7pt;
  color: var(--theme-text-secondary);
  writing-mode: vertical-rl;
  text-orientation: upright;
  letter-spacing: 0.5mm;
  max-height: 100%;
  overflow: hidden;
  font-family: var(--font-family);
}

/* 支付方式单元格 */
.payment-cell {
  flex: 0 0 auto;
  gap: 0.5mm;
  padding: 1mm 0;
}

.payment-type {
  font-size: 7pt;
  color: var(--theme-primary);
  font-weight: bold;
  font-family: var(--font-family-fixed);
}

.amount-number {
  font-size: 7pt;
  color: var(--theme-text-secondary);
  font-family: var(--font-family-fixed);
}

/* ==================== 页脚 ==================== */
.print-footer {
  display: flex;
  justify-content: space-between;
  align-items: center;
  margin-top: 2mm;
  padding-top: 2mm;
  border-top: 1px solid rgba(255, 255, 255, 0.3);
  color: rgba(255, 255, 255, 0.9);
  font-size: 9pt;
}

.footer-left {
  flex: 1;
  text-align: left;
}

.footer-center {
  flex: 1;
  text-align: center;
}

.footer-right {
  flex: 1;
  text-align: right;
}

/* ==================== 打印优化 ==================== */
@media print {
  body {
    background: var(--theme-primary);
  }
  
  .record-column {
    page-break-inside: avoid;
    break-inside: avoid;
  }
}

/* ==================== 汇总列样式 ==================== */
.summary-column {
  background: rgba(255, 255, 255, 0.95);
  border: 0.5mm solid var(--theme-primary);
}

.summary-column .label-text {
  color: var(--theme-primary);
  font-size: 10pt;
  font-family: var(--font-family-fixed);
}

.summary-name-cell {
  flex: 0 0 auto;
  height: 38mm;
  min-height: 35mm;
  justify-content: center;
  display: flex;
  align-items: center;
}

.summary-text-vertical {
  font-weight: bold;
  color: var(--theme-primary);
  writing-mode: vertical-rl;
  text-orientation: upright;
  letter-spacing: 1mm;
  font-size: 14pt;
  line-height: 1.4;
  font-family: var(--font-name-amount);
}

.summary-amount-cell {
  flex: 0 0 auto;
  height: 40mm;
  min-height: 35mm;
  justify-content: center;
  display: flex;
  align-items: center;
}

.summary-number-vertical {
  font-weight: bold;
  color: var(--theme-primary);
  font-size: 12pt;
  transform: rotate(90deg);
  white-space: nowrap;
}

/* ==================== 隐藏滚动条 ==================== */
::-webkit-scrollbar {
  display: none;
}
